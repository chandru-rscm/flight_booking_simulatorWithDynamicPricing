<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Select Seats | SkyBook</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* --- LAYOUT --- */
        .booking-wrapper {
            display: flex;
            gap: 40px;
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
            align-items: flex-start;
        }
        
        /* --- LEFT: PASSENGER FORM --- */
        .passenger-section {
            flex: 1;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        .passenger-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
            transition: 0.3s;
            position: relative;
        }
        .passenger-card:hover { border-color: #ff4d88; }
        .passenger-number {
            position: absolute; right: 10px; top: 10px;
            font-size: 50px; color: #f1f5f9; font-weight: 800; z-index: 0; pointer-events: none;
        }

        /* --- RIGHT: SEAT MAP --- */
        .seat-section {
            flex: 1.2;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            text-align: center;
            position: relative;
        }

        /* Plane Visuals */
        .plane-body {
            background: #f8fafc;
            padding: 80px 50px 50px 50px;
            border-radius: 150px 150px 30px 30px; /* More rounded nose */
            border: 4px solid #cbd5e1;
            display: inline-block;
            position: relative;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.05);
        }

        .cockpit {
            position: absolute;
            top: 30px; left: 50%; transform: translateX(-50%);
            width: 70px; height: 35px;
            background: linear-gradient(180deg, #334155, #64748b);
            border-radius: 40px 40px 10px 10px;
            border: 2px solid #1e293b;
            opacity: 0.8;
        }

        .wing-left, .wing-right {
            position: absolute; top: 180px; width: 120px; height: 200px;
            background: #e2e8f0; border: 3px solid #cbd5e1; z-index: 0;
        }
        .wing-left { left: -110px; border-radius: 20px 0 0 80%; transform: skewY(15deg); }
        .wing-right { right: -110px; border-radius: 0 20px 80% 0; transform: skewY(-15deg); }

        /* Seat Grid */
        .seats-grid {
            display: grid; gap: 12px; justify-content: center;
            position: relative; z-index: 1;
        }
        
        /* --- SEAT STYLING (CRITICAL FIXES) --- */
        .seat {
            width: 45px; height: 55px;
            background: #cbd5e1; /* Default Grey */
            border-radius: 8px 8px 15px 15px;
            cursor: pointer;
            font-size: 11px; color: #555;
            display: flex; align-items: center; justify-content: center;
            transition: 0.2s; position: relative; font-weight: bold;
            box-shadow: 0 4px 0 #94a3b8;
        }
        
        .seat::before { /* Headrest */
            content: ''; position: absolute; top: -5px; width: 80%; height: 12px;
            background: inherit; border-radius: 4px; opacity: 0.8;
        }

        .seat:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .seat:active { transform: translateY(2px); box-shadow: 0 1px 0 #94a3b8; }
        
        /* 1. OCCUPIED */
        .seat.occupied {
            background: #e2e8f0; color: #ccc; cursor: not-allowed;
            box-shadow: none; opacity: 0.6;
        }

        /* 2. BUSINESS CLASS (Base Style) */
        .seat.business {
            width: 60px; height: 65px;
            background: #fcd34d; /* Gold */
            color: #78350f;
            box-shadow: 0 4px 0 #d97706;
        }

        /* 3. SELECTED (ECONOMY) - Defined AFTER to override */
        .seat.selected {
            background: #ff4d88 !important; /* Force Pink */
            color: white !important;
            box-shadow: 0 4px 0 #be123c !important;
            transform: scale(1.05);
        }

        /* 4. SELECTED (BUSINESS) - Specific Override for Premium Look */
        .seat.business.selected {
            background: #ea580c !important; /* Dark Orange/Red */
            color: white !important;
            box-shadow: 0 4px 0 #9a3412 !important;
        }

        /* Tooltip */
        .seat:hover::after {
            content: attr(data-price);
            position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%);
            background: #1e293b; color: white; padding: 5px 10px;
            border-radius: 6px; font-size: 11px; white-space: nowrap; z-index: 10;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .aisle { width: 30px; }

        /* Legend */
        .legend-box {
            display: flex; gap: 20px; justify-content: center; 
            margin-top: 25px; font-size: 13px; color: #64748b;
            background: #f8fafc; padding: 15px; border-radius: 12px;
        }
        .dot { width: 14px; height: 14px; border-radius: 4px; display: inline-block; margin-right: 6px; vertical-align: middle; }

    </style>
</head>
<body>

    <div class="navbar">
        <h2>SkyBook ✈️</h2>
        <a href="search.html" style="color: #666; font-weight: 600; text-decoration: none;">← Back to Search</a>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <h1 style="color: #1e293b; margin: 0;">Select Seats</h1>
        <p style="color: #64748b; margin-top: 5px;" id="flightRouteDisplay">Loading Flight...</p>
    </div>

    <div class="booking-wrapper">
        
        <div class="passenger-section">
            <h3 style="color: #ff4d88; border-bottom: 2px solid #f1f5f9; padding-bottom: 15px; margin-top: 0;">1. Travelers</h3>
            
            <div id="passengersContainer"></div>

            <button onclick="addPassengerForm()" style="background: #e2e8f0; color: #333; padding: 14px; border: none; border-radius: 10px; cursor: pointer; font-weight: 700; width: 100%; margin-top: 15px; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 10px;">
                <span>+</span> Add Another Traveler
            </button>
        </div>

        <div class="seat-section">
            <h3 style="color: #ff4d88; border-bottom: 2px solid #f1f5f9; padding-bottom: 15px; margin-top: 0;">2. Cabin Map</h3>
            
            <div style="background: #f1f5f9; padding: 6px; border-radius: 40px; display: inline-flex; margin-bottom: 20px; border: 1px solid #e2e8f0;">
                <button id="btnEco" onclick="setSeatClass('economy')" style="padding: 10px 30px; border-radius: 30px; border: none; cursor: pointer; background: #fff; color: #333; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: 0.3s;">Economy</button>
                <button id="btnBiz" onclick="setSeatClass('business')" style="padding: 10px 30px; border-radius: 30px; border: none; cursor: pointer; background: transparent; color: #666; font-weight: bold; transition: 0.3s;">Business</button>
            </div>

            <div style="position: relative; margin-top: 20px;">
                <div class="wing-left"></div>
                <div class="wing-right"></div>
                
                <div class="plane-body">
                    <div class="cockpit"></div>
                    <div class="seats-grid" id="seatMap">
                        </div>
                </div>
            </div>

            <div class="legend-box">
                <div><span class="dot" style="background:#cbd5e1; box-shadow: 0 2px 0 #94a3b8;"></span>Standard</div>
                <div><span class="dot" style="background:#fcd34d; box-shadow: 0 2px 0 #d97706;"></span>Business</div>
                <div><span class="dot" style="background:#ff4d88; box-shadow: 0 2px 0 #be123c;"></span>Selected</div>
                <div><span class="dot" style="background:#e2e8f0;"></span>Occupied</div>
            </div>

            <div style="margin-top: 30px; background: #f8fafc; padding: 25px; border-radius: 16px; border: 1px solid #e2e8f0;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: #64748b;">
                    <span>Base Fare (x<span id="pCount">1</span>)</span>
                    <span id="baseFareDisplay">₹0</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px; color: #ea580c;">
                    <span>Surcharges (Window/Aisle)</span>
                    <span id="surchargeDisplay">₹0</span>
                </div>
                <hr style="border: 0; border-top: 2px dashed #e2e8f0; margin-bottom: 15px;">
                <div style="display: flex; justify-content: space-between; font-weight: 800; font-size: 26px; color: #0f172a;">
                    <span>Total</span>
                    <span id="totalFareDisplay">₹0</span>
                </div>
                <button id="payButton" onclick="confirmBooking()" disabled style="width: 100%; padding: 18px; background: #cbd5e1; color: white; border: none; border-radius: 12px; margin-top: 20px; font-size: 18px; font-weight: bold; cursor: not-allowed; transition: 0.3s;">
                    Select Seats
                </button>
            </div>
        </div>
    </div>

    <script src="js/booking.js"></script>
</body>
</html>